# ุงุณุชุฑุงุชฺ ุฌุฑุงู ุฏุงุฏู ุฏุฑ Smart Whale

## ๐ฏ ููุฏูู
ุงู ุณูุฏ ุงุณุชุฑุงุชฺ ุจููู ุฌุฑุงู ุฏุงุฏู ุจู ุณุฑูุณโูุง ูุฎุชูู ุฏุฑ ูพุฑูฺู Smart Whale ุฑุง ุชูุถุญ ูโุฏูุฏ. ูุฏู ุงุตูุ ุญุฏุงููโุณุงุฒ ูพุฑุฏุงุฒุด ู ุฑุณุฏู ุจู ุจูุชุฑู ฺฉุงุฑุง ุงุณุช.

## ๐ ูุนูุงุฑ ฺฉู ุณุณุชูโูุง

ุณุณุชู ุงุฒ ุงุฌุฒุง ุฒุฑ ุชุดฺฉู ุดุฏู ุงุณุช:
- **Kafka**: ุจุฑุง ูุฏุฑุช ุฌุฑุงู ุฏุงุฏู
- **Redis**: ุจุฑุง ฺฉุด ู lookup ุณุฑุน
- **ClickHouse**: ุจุฑุง ุฐุฎุฑู ุฏุงุฏูโูุง ูพุฑุฏุงุฒุด ุดุฏู
- **TimescaleDB**: ุจุฑุง ุฏุงุฏูโูุง ุณุฑ ุฒูุงู ู ูุชุฑฺฉโูุง
- **Milvus**: ุจุฑุง ุฐุฎุฑู ู ุฌุณุชุฌู ุจุฑุฏุงุฑูุง ูุนูุง
- **MinIO**: ุจุฑุง ูุฏุฑุช ู ุฐุฎุฑู ูุงูโูุง

## ๐ ุฌุฑุงูโูุง ุฏุงุฏู

### 1. ุฌุฑุงู ุฏุงุฏู ุฎุงู
```mermaid
graph LR
    A[DATA MODULE] --> B[Kafka raw_data] --> C[Model Processors]
```

**ูฺฺฏโูุง:**
- ุฏุงุฏูโูุง ุฎุงู ููุท ุฏุฑ Kafka ููุชุดุฑ ูโุดููุฏ
- ูุฑ ูุฏู ุงุฒ ุชุงูพฺฉ ูุฎุตูุต ุจู ุฎูุฏ ูุตุฑู ูโฺฉูุฏ
- ูุงุฒ ุจู ุฐุฎุฑูโุณุงุฒ ุฏุงุฏู ุฎุงู ูุณุช

### 2. ูุฏุฑุช ูุงูโูุง
```mermaid
graph TD
    A[Files] --> B[File Manager]
    B --> C[MinIO Object Storage]
    B --> D[Redis metadata/hashes]
    B --> E[Kafka file_processed]
```

**ูฺฺฏโูุง:**
- ุฐุฎุฑู ูุงูโูุง ุฏุฑ MinIO
- ูฺฏูุฏุงุฑ ูุด ู ูุชุงุฏุชุง ุฏุฑ Redis
- ุงุทูุงุนโุฑุณุงู ูพุฑุฏุงุฒุด ุงุฒ ุทุฑู Kafka

### 3. ูุฏุฑุช Embeddingโูุง
```mermaid
graph LR
    A[Processed Text] --> B[Embeddings]
    B --> C[Milvus]
    B --> D[Redis cache]
    B --> E[Kafka embeddings_ready]
```

**ูฺฺฏโูุง:**
- ุฐุฎุฑู ุจุฑุฏุงุฑูุง ูุนูุง ุฏุฑ Milvus
- ฺฉุด ฺฉุฑุฏู ุจุฑุฏุงุฑูุง ูพุฑฺฉุงุฑุจุฑุฏ ุฏุฑ Redis
- ุงุนูุงู ุขูุงุฏู ุดุฏู embeddingโูุง ุงุฒ ุทุฑู Kafka

### 4. ุฏุงุฏูโูุง ูพุฑุฏุงุฒุด ุดุฏู
```mermaid
graph LR
    A[Model Results] --> B[ClickHouse]
    B --> C[Redis frequent queries]
```

**ูฺฺฏโูุง:**
- ุฐุฎุฑู ูุชุงุฌ ุฏุฑ ClickHouse
- ฺฉุด ฺฉุฑุฏู ฺฉูุฆุฑโูุง ูพุฑุชฺฉุฑุงุฑ ุฏุฑ Redis

### 5. ูุชุฑฺฉโูุง ู ูุงูุชูุฑูฺฏ
```mermaid
graph LR
    A[Metrics] --> B[TimescaleDB]
    B --> C[Redis current metrics]
```

**ูฺฺฏโูุง:**
- ุฐุฎุฑู ุฏุงุฏูโูุง ุณุฑ ุฒูุงู ุฏุฑ TimescaleDB
- ูฺฏูุฏุงุฑ ูุชุฑฺฉโูุง ูุนู ุฏุฑ Redis

## ๐ก๏ธ ุงุณุชุฑุงุชฺโูุง ุจูููโุณุงุฒ

### 1. ุฌููฺฏุฑ ุงุฒ ูพุฑุฏุงุฒุด ุชฺฉุฑุงุฑ
```mermaid
graph TD
    A[Input Data] --> B{Redis Check Hash}
    B -->|New| C[Process Data]
    C --> D[Update Redis Hash]
    B -->|Duplicate| E[Skip Processing]
```

**ูฺฉุงูุฒู:**
- ุจุฑุฑุณ ูุด ุฏุงุฏู ุฏุฑ Redis ูุจู ุงุฒ ูพุฑุฏุงุฒุด
- ูพุฑุฏุงุฒุด ููุท ุฏุงุฏูโูุง ุฌุฏุฏ
- ุขูพุฏุช ูุด ูพุณ ุงุฒ ูพุฑุฏุงุฒุด

### 2. ูุฏุฑุช ฺฉุด
Redis ุจู ุนููุงู ูุงู ฺฉุด ุจุฑุง ููุงุฑุฏ ุฒุฑ ุงุณุชูุงุฏู ูโุดูุฏ:
- ูุดโูุง ูุงู ู ุฏุงุฏู
- ุจุฑุฏุงุฑูุง ูพุฑฺฉุงุฑุจุฑุฏ Milvus
- ูุชุงุฌ ฺฉูุฆุฑโูุง ูพุฑุชฺฉุฑุงุฑ ClickHouse
- ูุชุฑฺฉโูุง ูุนู
- ูุถุนุช ูพุฑุฏุงุฒุดโูุง

## ๐ ูุฒุงุง ุงู ุงุณุชุฑุงุชฺ

1. **ฺฉุงูุด ูพุฑุฏุงุฒุด:**
   - ุฌููฺฏุฑ ุงุฒ ูพุฑุฏุงุฒุด ุฏุงุฏูโูุง ุชฺฉุฑุงุฑ
   - ุงุณุชูุงุฏู ุงุฒ ฺฉุด ุจุฑุง ุฏุงุฏูโูุง ูพุฑฺฉุงุฑุจุฑุฏ
   - ูพุฑุฏุงุฒุด ุชุฏุฑุฌ ู ุจููู ุฏุงุฏูโูุง

2. **ุจูููโุณุงุฒ ููุงุจุน:**
   - ุงุณุชูุงุฏู ุงุฒ ุณุณุชู ููุงุณุจ ุจุฑุง ูุฑ ููุน ุฏุงุฏู
   - ูุฏุฑุช ุจููู ุญุงูุธู
   - ฺฉุงูุด ุจุงุฑ ุฑู ุณุณุชูโูุง

3. **ูุงุจูุช ุงุทููุงู:**
   - ุฐุฎุฑู ุฏุงุฏูโูุง ุฏุฑ ุณุณุชูโูุง ุชุฎุตุต
   - ูพุดุชุจุงูโฺฏุฑ ู ุจุงุฒุงุจ ุขุณุงู
   - ูุฏุฑุช ุฎุทุง ู retry

4. **ููุงุณโูพุฐุฑ:**
   - ุงูฺฉุงู ุงูุฒูุฏู nodeโูุง ุฌุฏุฏ
   - ุชูุฒุน ุจุงุฑ ุจู ุณุณุชูโูุง
   - ุงูุนุทุงูโูพุฐุฑ ุฏุฑ ุชูุณุนู

## ๐ ูฺฉุงุช ูพุงุฏูโุณุงุฒ

1. **ูุฏุฑุช ฺฉุด:**
   - TTL ููุงุณุจ ุจุฑุง ุฏุงุฏูโูุง ฺฉุด ุดุฏู
   - ุงุณุชุฑุงุชฺ eviction ููุงุณุจ
   - ูุงูุชูุฑูฺฏ ุญุฌู ฺฉุด

2. **ูุฏุฑุช Kafka:**
   - ูพุงุฑุชุดูโุจูุฏ ููุงุณุจ ุชุงูพฺฉโูุง
   - ุชูุธู retention period
   - ูุฏุฑุช consumer groupโูุง

3. **ุจูููโุณุงุฒ ุฐุฎุฑูโุณุงุฒ:**
   - ุณุงุณุชโูุง ุขุฑุดู ุฏุงุฏู
   - ูุฏุฑุช ูุถุง ุฏุณฺฉ
   - ุจูููโุณุงุฒ ฺฉูุฆุฑโูุง

## ๐ ูุชุฌูโฺฏุฑ

ุงู ุงุณุชุฑุงุชฺ ุจุง ุงุณุชูุงุฏู ุจููู ุงุฒ ุณุณุชูโูุง ูุฎุชูู ู ุทุฑุงุญ ุฌุฑุงู ุฏุงุฏู ฺฉุงุฑุขูุฏุ ุจู ุงูุฏุงู ุฒุฑ ุฏุณุช ูโุงุจุฏ:
- ุญุฏุงููโุณุงุฒ ูพุฑุฏุงุฒุด
- ุจูููโุณุงุฒ ูุตุฑู ููุงุจุน
- ูุงุจูุช ุงุทููุงู ุจุงูุง
- ููุงุณโูพุฐุฑ ููุงุณุจ
